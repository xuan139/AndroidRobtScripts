<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>à¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡à¸”à¹‰à¸§à¸¢à¹€à¸ªà¸µà¸¢à¸‡ (é€é¢˜è¯­éŸ³é—®ç­”)</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f6f9;
      color: #333;
      margin: 0;
      padding: 40px;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }
    h2 {
      text-align: center;
      color: #2b7bba;
    }
    button {
      display: block;
      margin: 20px auto;
      background-color: #2b7bba;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 18px;
      cursor: pointer;
      transition: background 0.3s;
    }
    button:hover {
      background-color: #1e5f8f;
    }
    #question {
      font-size: 20px;
      text-align: center;
      margin: 30px 0 10px;
      min-height: 70px; /* é«˜ä¸€ç‚¹ï¼Œé˜²æ­¢æ¢è¡Œé—ªçƒ */
      white-space: pre-line; /* æ”¯æŒæ¢è¡Œ */
    }
    #answer {
      text-align: center;
      font-size: 18px;
      color: green;
      margin-bottom: 20px;
      min-height: 24px;
    }
    #result {
      background: #f9f9f9;
      border-radius: 8px;
      padding: 15px;
      white-space: pre-wrap;
      font-size: 14px;
      color: #444;
      overflow: auto;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ğŸ¤ à¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡à¸”à¹‰à¸§à¸¢à¹€à¸ªà¸µà¸¢à¸‡ (é€é¢˜è¯­éŸ³é—®ç­”)</h2>
    <button id="startBtn">â–¶ à¹€à¸£à¸´à¹ˆà¸¡à¸•à¸­à¸šà¹à¸šà¸šà¸ªà¸­à¸šà¸–à¸²à¸¡</button>
    <div id="question">à¸„à¸³à¸–à¸²à¸¡à¸ˆà¸°à¹à¸ªà¸”à¸‡à¸—à¸µà¹ˆà¸™à¸µà¹ˆ</div>
    <div id="answer"></div>
    <pre id="result">{}</pre>
  </div>

  <script>
    const questions = [
      { textTh: "1. à¸„à¸¸à¸“à¸Šà¸·à¹ˆà¸­à¸­à¸°à¹„à¸£", textCn: "ä½ å«ä»€ä¹ˆåå­—", key: "name" },
      { textTh: "2. à¸„à¸¸à¸“à¸­à¸²à¸¢à¸¸à¹€à¸—à¹ˆà¸²à¹„à¸«à¸£à¹ˆ", textCn: "ä½ å¤šå¤§äº†", key: "age" },
      { textTh: "3. à¹€à¸à¸¨à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸„à¸·à¸­à¸­à¸°à¹„à¸£", textCn: "ä½ çš„æ€§åˆ«æ˜¯ä»€ä¹ˆ", key: "gender" },
      { textTh: "4. à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¸‚à¸­à¸‡à¸„à¸¸à¸“à¸„à¸·à¸­à¸­à¸°à¹„à¸£", textCn: "ä½ çš„åœ°å€æ˜¯ä»€ä¹ˆ", key: "address" },
      { textTh: "5. à¸­à¸²à¸Šà¸µà¸à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸„à¸·à¸­à¸­à¸°à¹„à¸£", textCn: "ä½ çš„èŒä¸šæ˜¯ä»€ä¹ˆ", key: "job" },
      { textTh: "6. à¸‡à¸²à¸™à¸­à¸”à¸´à¹€à¸£à¸à¸‚à¸­à¸‡à¸„à¸¸à¸“à¸„à¸·à¸­à¸­à¸°à¹„à¸£", textCn: "ä½ çš„å…´è¶£çˆ±å¥½æ˜¯ä»€ä¹ˆ", key: "hobbies" },
      { textTh: "7. à¸­à¸²à¸«à¸²à¸£à¸—à¸µà¹ˆà¸„à¸¸à¸“à¸Šà¸­à¸š", textCn: "ä½ å–œæ¬¢ä»€ä¹ˆé£Ÿç‰©", key: "food" },
      { textTh: "8. à¸„à¸¸à¸“à¸¡à¸µà¸ªà¸±à¸•à¸§à¹Œà¹€à¸¥à¸µà¹‰à¸¢à¸‡à¹„à¸«à¸¡", textCn: "ä½ æœ‰å® ç‰©å—", key: "pets" },
      { textTh: "9. à¸„à¸¸à¸“à¸à¸¹à¸”à¸ à¸²à¸©à¸²à¸­à¸°à¹„à¸£", textCn: "ä½ è¯´ä»€ä¹ˆè¯­è¨€", key: "language" },
      { textTh: "10. à¸ªà¸µà¸—à¸µà¹ˆà¸„à¸¸à¸“à¸Šà¸­à¸š", textCn: "ä½ å–œæ¬¢ä»€ä¹ˆé¢œè‰²", key: "color" }
    ];

    const questionEl = document.getElementById("question");
    const answerEl = document.getElementById("answer");
    const resultEl = document.getElementById("result");
    const startBtn = document.getElementById("startBtn");

    let currentIndex = 0;
    const answers = {};

    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = "th-TH";
    recognition.interimResults = false;
    recognition.continuous = false;

    startBtn.addEventListener("click", () => {
      currentIndex = 0;
      Object.keys(answers).forEach(k => delete answers[k]);
      resultEl.textContent = "{}";
      askQuestion();
      startBtn.disabled = true;
    });

    function askQuestion() {
      if (currentIndex >= questions.length) {
        questionEl.textContent = "âœ… à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™à¸—à¸¸à¸à¸„à¸³à¸–à¸²à¸¡à¹à¸¥à¹‰à¸§ à¸‚à¸­à¸šà¸„à¸¸à¸“à¸„à¹ˆà¸° / å®Œæˆæ‰€æœ‰é—®é¢˜ï¼Œè°¢è°¢ï¼";
        answerEl.textContent = "";
        startBtn.disabled = false;
        return;
      }

      const currentQ = questions[currentIndex];
      questionEl.textContent = `${currentQ.textTh}\n${currentQ.textCn}`;
      answerEl.textContent = "ğŸ¤ à¸à¸£à¸¸à¸“à¸²à¸à¸¹à¸”à¸•à¸­à¸š...";
      recognition.lang = "th-TH";

      if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(currentQ.textTh);
        utterance.lang = 'th-TH';
        speechSynthesis.cancel();
        speechSynthesis.speak(utterance);
        utterance.onend = () => {
          startRecognition();
        };
      } else {
        startRecognition();
      }
    }

    function startRecognition() {
      recognition.abort();
      recognition.start();
    }

    recognition.onresult = (event) => {
      const transcript = event.results[0][0].transcript.trim();
      answerEl.textContent = `âœ… à¸„à¸³à¸•à¸­à¸š: ${transcript}`;

      if (questions[currentIndex].key === "gender") {
        const lower = transcript.toLowerCase();
        if (["à¸Šà¸²à¸¢", "à¸œà¸¹à¹‰à¸Šà¸²à¸¢", "man", "male"].some(w => lower.includes(w))) {
          answers["gender"] = "à¸Šà¸²à¸¢ / ç”·";
        } else if (["à¸«à¸à¸´à¸‡", "à¸œà¸¹à¹‰à¸«à¸à¸´à¸‡", "woman", "female"].some(w => lower.includes(w))) {
          answers["gender"] = "à¸«à¸à¸´à¸‡ / å¥³";
        } else {
          answers["gender"] = transcript;
        }
      } else {
        answers[questions[currentIndex].key] = transcript;
      }

      resultEl.textContent = JSON.stringify(answers, null, 2);
      currentIndex++;
    };

    recognition.onend = () => {
      if (currentIndex < questions.length) {
        setTimeout(askQuestion, 1000);
      } else {
        questionEl.textContent = "âœ… à¹€à¸ªà¸£à¹‡à¸ˆà¸ªà¸´à¹‰à¸™à¸—à¸¸à¸à¸„à¸³à¸–à¸²à¸¡à¹à¸¥à¹‰à¸§ à¸‚à¸­à¸šà¸„à¸¸à¸“à¸„à¹ˆà¸° / å®Œæˆæ‰€æœ‰é—®é¢˜ï¼Œè°¢è°¢ï¼";
        answerEl.textContent = "";
        startBtn.disabled = false;
      }
    };

    recognition.onerror = (event) => {
      answerEl.textContent = "âŒ à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”: " + event.error;
      recognition.abort();
      startBtn.disabled = false;
    };
  </script>
</body>
</html>
